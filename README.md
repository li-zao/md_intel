Maildata 情报库
===============

> 运行环境要求PHP7.1+，兼容PHP8.0。


## 备注
- 默认用户：admin，密码：maildata@618
- 数据库表需要innodb引擎类型
- php.ini：
  - post_max_size => 10M => 10M
  - upload_max_filesize => 10M => 10M## 主要新特性

- nginx:
  - client_max_body_size => 10M

## Misc
- 截至2025.02.11，确认当前模型训练所用数据量，正常URL：71879，恶意URL：211264。
- 模型训练配置：向量数：27，训练次数：100，正常数据倍数：3。
- 服务重启：/etc/init.d/unnpredict restart
- 配置文件：/opt/urlnn/conf/urlnn.conf
- 输入：csv > 向量 > 模型 > 结果文件
- 输出：结果文件 urlnn.h5，配置文件：/opt/urlnn/conf/urlnn.conf
- 更新操作：@TODO:在线升级，待讨论

### 删除
#### 图片
正常 - 训练: 40/332191
正常 - 预测: 1970/332191
恶意 - 训练: 69/332191
恶意 - 预测: 785/332191
#### 内网IP
48/332191
#### IP域名
1201/332191
#### 无效URL
37/332191

## 2025.03.05 向量统计
- 正常URL - 训练：总数 70726 ， 未知 1 ，     正常 70361 ，恶意 364
- 正常URL - 预测：总数 8562 ，  未知 357 ，   正常 7125 ， 恶意 1080 检出率：83%（去除未知 86.8%）
- 恶意URL - 训练：总数 229693 ，未知 153689 ，正常 772 ，  恶意 75232 (vector缓存补充)
- 恶意URL - 预测：总数 7502  ， 未知 5659 ，  正常 1346 ， 恶意 497 检出率：6%（去除未知 26.9%）

## 2025.03.17 向量统计
- 正常URL - 训练：总数 70685 ， 未知 1，      正常 70321 ，恶意 363 
- 正常URL - 预测：总数 6580 ，  未知 276 ，   正常 5346 ， 恶意 958 正常检出率：84.8%，恶意检出率：15.2%
- 恶意URL - 训练：总数 229589 ，未知 153603 ，正常 773 ，  恶意 75213
- 恶意URL - 预测：总数 6688  ， 未知 5188  ， 正常 1036  ，恶意 464 。正常检出率：69%，恶意检出率：31%

## 2025.03.21 向量统计
- 正常URL - 训练：总数 70684 ， 未知 0，      正常 70321 ，恶意 363 
- 正常URL - 预测：总数 6580 ，  未知 276 ，   正常 5346 ， 恶意 958 正常检出率：84.8%，恶意检出率：15.2%
- 恶意URL - 训练：总数 229589 ，未知 149525 ，正常 1309 ， 恶意 78755
- 恶意URL - 预测：总数 6688  ， 未知 4477  ， 正常 1667  ，恶意 544 正常检出率：75.3%，恶意检出率：24.7%

## 2025.03.24 向量统计
- 正常URL - 训练：总数 70684 ， 未知 0，      正常 70321 ，恶意 363 
- 正常URL - 预测：总数 6580 ，  未知 217 ，   正常 5392 ， 恶意 971 正常检出率：84.7%，恶意检出率：15.3%
- 恶意URL - 训练：总数 229589 ，未知 149040 ，正常 1399 ， 恶意 79150
- 恶意URL - 预测：总数 6688  ， 未知 4430  ， 正常 1713  ，恶意 545 正常检出率：75.9%，恶意检出率：24.1%

## 2025.04.03 向量统计
- 正常URL - 训练：总数 70684 ， 未知 0 ， 正常 70321 ，恶意 363 
- 正常URL - 预测：总数 6363 ，  未知 0 ， 正常 5393 ， 恶意 970 正常检出率：84.8%，恶意检出率：15.2%
- 恶意URL - 训练：总数 80547 ， 未知 0 ， 正常 1397 ， 恶意 79150
- 恶意URL - 预测：总数 2258 ，  未知 0 ， 正常 1713  ，恶意 545 正常检出率：75.9%，恶意检出率：24.1%

## 2025.04.17 向量统计
- 正常URL - 训练：总数 70677 ， 未知 0 ， 正常 61006 ， 恶意 9671
- 正常URL - 预测：总数 6363 ，  未知 0 ， 正常 2829 ，  恶意 3534 正常检出率：44.5%，恶意检出率：55.5%
- 恶意URL - 训练：总数 80542 ， 未知 0 ， 正常 13257 ， 恶意 67285
- 恶意URL - 预测：总数 2258 ，  未知 0 ， 正常 970  ，  恶意 1288 正常检出率：42.9%，恶意检出率：57.1%

+---------+-------+-------+--------+-------+--------+
| 类型    | 总数   | 正常   | 比例   | 恶意  | 比例    |
+---------+-------+-------+--------+-------+--------+
| 正常 - 训练 | 70677 | 68719 | 97.23% | 1958  | 2.77%  |
| 恶意 - 训练 | 80542 | 24924 | 30.95% | 55618 | 69.05% |
+---------+-------+-------+--------+-------+--------+
## 2025.04.21 验证：
- 恶意中的正常：验证 300， 正常 45， 比例 15%
- 正常中的恶意：验证 100， 恶意 10， 比例 10%

## 2025.04.23 向量统计
+------------+-------+-------+--------+-------+--------+
| 类型       | 总数   | 正常   | 比例   | 恶意   | 比例   |
+------------+-------+-------+--------+-------+--------+
| 正常 - 训练 | 70677 | 68719 | 97.23% | 1958  | 2.77%  |
| 正常 - 预测 | 6365  | 5380  | 84.52% | 985   | 15.48% |
| 恶意 - 训练 | 80542 | 24924 | 30.95% | 55618 | 69.05% |
| 恶意 - 预测 | 2258  | 1612  | 71.39% | 646   | 28.61% |
+------------+-------+-------+--------+-------+--------+
+-------------+-------+-------+--------+-------+--------+
| 类型        | 总数   | 正常   | 比例   | 恶意   | 比例   |
+-------------+-------+-------+--------+-------+--------+
| 正常 - 训练  | 70677 | 68719 | 97.23% | 1958  | 2.77%  |
| 正常 - 预测  | 6365  | 5380  | 84.52% | 985   | 15.48% |
| 恶意 - 训练  | 80542 | 24924 | 30.95% | 55618 | 69.05% |
| 恶意 - 预测  | 69    | 39    | 56.52% | 30    | 43.48% |
+-------------+-------+-------+--------+-------+--------+
+-------------+-------+-------+--------+-------+--------+
| 类型        | 总数   | 正常   | 比例   | 恶意   | 比例   |
+-------------+-------+-------+--------+-------+--------+
| 正常 - 训练  | 70677 | 68719 | 97.23% | 1958  | 2.77%  |
| 正常 - 预测  | 6365  | 5380  | 84.52% | 985   | 15.48% |
| 恶意 - 训练  | 80542 | 24924 | 30.95% | 55618 | 69.05% |
| 恶意 - 预测  | 2327  | 1651  | 70.95% | 676   | 29.05% |
+-------------+-------+-------+--------+-------+--------+

## 2025.04.24
### https://github.com/pirocheto/phishing-url-detection 
+-------------+-------+-------+--------+-------+--------+
| 类型        | 总数   | 正常   | 比例   | 恶意   | 比例   |
+-------------+-------+-------+--------+-------+--------+
| 正常 - 训练  | 70677 | 39144 | 55.38% | 31533 | 44.62% |
| 正常 - 预测  | 6365  | 1647  | 25.88% | 4718  | 74.12% |
| 恶意 - 训练  | 80542 | 20537 | 25.5%  | 60005 | 74.5%  |
| 恶意 - 预测  | 2706  | 439   | 16.22% | 2267  | 83.78% |
+-------------+-------+-------+--------+-------+--------+
### https://huggingface.co/CrabInHoney/urlbert-tiny-v4-phishing-classifier
+-------------+-------+-------+--------+-------+--------+
| 类型        | 总数   | 正常   | 比例   | 恶意   | 比例   |
+-------------+-------+-------+--------+-------+--------+
| 正常 - 训练  | 70677 | 57003 | 80.65% | 13674 | 19.35% |
| 正常 - 预测  | 6365  | 2848  | 44.74% | 3517  | 55.26% |
| 恶意 - 训练  | 80542 | 12083 | 15%    | 68459 | 85%    |
| 恶意 - 预测  | 2706  | 509   | 18.81% | 2197  | 81.19% |
+-------------+-------+-------+--------+-------+--------+

+-------------+-------+-------+--------+-------+--------+
| 类型        | 总数   | 正常   | 比例   | 恶意   | 比例   |
+-------------+-------+-------+--------+-------+--------+
| 正常 - 训练  | 70677 | 40141 | 56.79% | 30536 | 43.21% |
| 正常 - 预测  | 6365  | 2557  | 40.17% | 3808  | 59.83% |
| 恶意 - 训练  | 80542 | 64336 | 79.88% | 16206 | 20.12% |
| 恶意 - 预测  | 2327  | 1026  | 44.09% | 1301  | 55.91% |
+-------------+-------+-------+--------+-------+--------+
### 双模型融合结果：
+-------------+-------+-------+--------+-------+--------+
| 类型        | 总数   | 正常   | 比例   | 恶意   | 比例   |
+-------------+-------+-------+--------+-------+--------+
| 正常 - 训练  | 70677 | 69680 | 98.59% | 997   | 1.41%  |
| 正常 - 预测  | 6365  | 5455  | 85.7%  | 910   | 14.3%  |
| 恶意 - 训练  | 80221 | 36578 | 45.6%  | 43643 | 54.4%  |
| 恶意 - 预测  | 2327  | 1700  | 73.06% | 627   | 26.94% |
+-------------+-------+-------+--------+-------+--------+

- 【正常 - 训练】中所有【恶意】的数据：990条；  第一个模型预测为【恶意】的：888条，   第二个模型预测为【恶意】的：975条
- 【正常 - 训练】中所有【恶意】的数据：990条；  第一个模型预测为【正常】的：102条，   第二个模型预测为【正常】的：15条
- 【恶意 - 训练】中所有【正常】的数据：36578条；第一个模型预测为【恶意】的：11798条， 第二个模型预测为【恶意】的：16096条
- 【恶意 - 训练】中所有【正常】的数据：36578条；第一个模型预测为【正常】的：24780条， 第二个模型预测为【正常】的：20482条
### 2025.05.06
+-------------+-------+-------+--------+-------+--------+
| 类型         | 总数  | 正常  | 比例    | 恶意   | 比例   |
+-------------+-------+-------+--------+-------+--------+
| 正常 - 训练  | 55354 | 50235 | 90.75% | 5119  | 9.25%  |
| 恶意 - 训练  | 61201 | 5635  | 9.21%  | 55566 | 90.79% |
+-------------+-------+-------+--------+-------+--------+
+-------------+-------+-------+--------+-------+--------+
| 类型        | 总数   | 正常   | 比例   | 恶意   | 比例   |
+-------------+-------+-------+--------+-------+--------+
| 正常 - 训练  | 50235 | 50235 | 100%   | 0     | 0%     |
| 正常 - 预测  | 5050  | 3347  | 66.28% | 1703  | 33.72% |
| 恶意 - 训练  | 55566 | 0     | 0%     | 55566 | 100%   |
| 恶意 - 预测  | 1828  | 1369  | 74.89% | 459   | 25.11% |
+-------------+-------+-------+--------+-------+--------+
+-------------+-------+-------+--------+-------+--------+
| 类型         | 总数   | 正常  | 比例   | 恶意   | 比例   |
+-------------+-------+-------+--------+-------+--------+
| 正常 - 训练  | 50235 | 50235 | 100%   | 0     | 0%     |
| 正常 - 预测  | 5050  | 2071  | 41.01% | 2979  | 58.99% |
| 恶意 - 训练  | 55566 | 0     | 0%     | 55566 | 100%   |
| 恶意 - 预测  | 1834  | 299   | 16.3%  | 1535  | 83.7%  |
+-------------+-------+-------+--------+-------+--------+

